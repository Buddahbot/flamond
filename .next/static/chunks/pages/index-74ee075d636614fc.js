(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4772)}])},4772:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return App}});var r=n(5893),s=n(7294),c=n(4465),i=n(6664),o=n(5087),a=n.n(o),components_AddressForm=()=>(0,r.jsx)("div",{children:(0,r.jsxs)("form",{className:a().topblue,children:[(0,r.jsx)("h3",{className:a().topblue,children:"Billing"}),(0,r.jsx)(i.AddressElement,{className:a().topblue,options:{mode:"billing"}})]})}),l=n(3115),u=n.n(l);function CheckoutForm(){let e=(0,i.useStripe)(),t=(0,i.useElements)(),[n,c]=(0,s.useState)(""),[o,a]=(0,s.useState)(null),[l,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(!e)return;let t=new URLSearchParams(window.location.search).get("payment_intent_client_secret");t&&e.retrievePaymentIntent(t).then(e=>{let{paymentIntent:t}=e;switch(t.status){case"succeeded":a("Payment succeeded!");break;case"processing":a("Your payment is processing.");break;case"requires_payment_method":a("Your payment was not successful, please try again.");break;default:a("Something went wrong.")}})},[e]);let handleSubmit=async n=>{if(n.preventDefault(),!e||!t)return;d(!0);let{error:r}=await e.confirmPayment({elements:t,confirmParams:{return_url:"http://localhost:3000/confirmationOfPayment"}});"card_error"===r.type||"validation_error"===r.type?a(r.message):a("An unexpected error occurred."),d(!1)};return(0,r.jsxs)("form",{id:"payment-form",onSubmit:handleSubmit,className:u().background,children:[(0,r.jsx)(i.LinkAuthenticationElement,{id:"link-authentication-element",onChange:e=>c(e.target.value)}),(0,r.jsx)(i.PaymentElement,{id:"payment-element",options:{layout:"tabs"}}),(0,r.jsx)("button",{disabled:l||!e||!t,id:"submit",className:u().buttonCheckout,children:(0,r.jsx)("span",{id:"button-text",children:l?(0,r.jsx)("div",{className:"spinner",id:"spinner"}):"Subscribe"})}),o&&(0,r.jsx)("div",{id:"payment-message",children:o})]})}var d=n(5675),p=n.n(d);n(9738).config();let m=n(8284)("sk_test_51O5M2yCFauPt80gYZEQ8OwczH7Z4NAy9rgOkw1wD2CleIf3nMiUdHq7C7e3Wdlbe2aisbdEeLuhMM8ZK5aOYsLps00GOkvI38F");async function fetchPrice(){try{let e=await m.prices.retrieve("price_1O6vKRCFauPt80gYvfYvXSy9");return e}catch(e){return console.log("error fetching price ==>>",e),null}}let h=n(8284)("sk_test_51O5M2yCFauPt80gYZEQ8OwczH7Z4NAy9rgOkw1wD2CleIf3nMiUdHq7C7e3Wdlbe2aisbdEeLuhMM8ZK5aOYsLps00GOkvI38F");async function fetchImage(){try{let e=await h.products.retrieve("prod_OukqjtDSU7kd2N");return e}catch(e){return console.log("error fetching image ==>> ",e),null}}var _=n(6103),g=n.n(_),components_ProductPriceAndDescription=e=>{let{onSubscriptionToggle:t}=e,[n,c]=(0,s.useState)(null),[i,o]=(0,s.useState)(null),[a,l]=(0,s.useState)(!1);return((0,s.useEffect)(async()=>{try{let e=await fetchImage();o(e.name)}catch(e){console.log("error while fetching image ==>>",e)}},[]),(0,s.useEffect)(async()=>{try{let e=await fetchPrice();c(e)}catch(e){console.log("error while fetching price ==>>",e)}},[]),n)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:g().wrapper,children:[(0,r.jsx)("div",{className:g().colPrice,children:(0,r.jsx)("p",{children:i})}),(0,r.jsx)("div",{className:g().colDescription,children:(0,r.jsxs)("p",{children:["$",n.unit_amount/100]})})]}),!a&&(0,r.jsx)("div",{className:g().buttonWrapper,children:(0,r.jsx)("p",{children:(0,r.jsx)("button",{onClick:()=>{t(!0),l(!0)},children:"Subscribe"})})})]}):(0,r.jsx)("div",{children:(0,r.jsx)("h1",{children:"Loading product price..."})})},f=n(7),x=n.n(f),components_ProductImage=()=>{let[e,t]=(0,s.useState)(null);return((0,s.useEffect)(async()=>{try{let e=await fetchImage();t(e)}catch(e){console.log("error while fetching image ==>>",e)}},[]),e)?(0,r.jsx)("div",{className:x().imageAlign,children:(0,r.jsx)(p(),{src:e.images[0],alt:"image of ".concat(e.name),width:300,height:300,priority:!0})}):(0,r.jsx)("div",{children:(0,r.jsx)("h1",{children:"Loading product Image..."})})},components_ProductRing=e=>{let{onSubscriptionToggle:t}=e,n=(0,c.J)("pk_test_51O5M2yCFauPt80gY4AhAp34JnuGZu6JlWyTKf10wsltqNYVB5ubpYv6WmZMYoABD6LpaG8NFfuGT1FmD56tIk5Om00QYUNc4kx");return(0,r.jsx)("div",{children:(0,r.jsxs)(i.Elements,{stripe:n,children:[(0,r.jsx)(components_ProductImage,{}),(0,r.jsx)(components_ProductPriceAndDescription,{onSubscriptionToggle:t})]})})};let b=(0,c.J)("pk_test_51O5M2yCFauPt80gY4AhAp34JnuGZu6JlWyTKf10wsltqNYVB5ubpYv6WmZMYoABD6LpaG8NFfuGT1FmD56tIk5Om00QYUNc4kx");function App(){let[e,t]=(0,s.useState)(""),[n,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:"xl-tshirt"}]})}).then(e=>e.json()).then(e=>t(e.clientSecret))},[]),console.log("here is subscriptionActive",n),(0,r.jsx)("div",{className:"App",children:e&&(0,r.jsxs)(i.Elements,{options:{clientSecret:e,appearance:{theme:"stripe"}},stripe:b,children:[(0,r.jsx)(components_ProductRing,{onSubscriptionToggle:e=>{c(e)}}),n&&(0,r.jsx)(components_AddressForm,{}),n&&(0,r.jsx)(CheckoutForm,{})]})})}},5087:function(e){e.exports={topblue:"AddressForm_topblue__rj_CV"}},3115:function(e){e.exports={background:"CheckoutForm_background__Xp4Us",buttonCheckout:"CheckoutForm_buttonCheckout__p_qwo"}},7:function(e){e.exports={imageAlign:"ProductImage_imageAlign__Hg4fd"}},6103:function(e){e.exports={wrapper:"ProductPriceAndDescription_wrapper__XD1RS",colDescription:"ProductPriceAndDescription_colDescription__iGQ18",colPrice:"ProductPriceAndDescription_colPrice__pPJkn",buttonWrapper:"ProductPriceAndDescription_buttonWrapper__R63nN"}},6647:function(){},4654:function(){}},function(e){e.O(0,[714,766,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);