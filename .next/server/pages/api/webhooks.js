"use strict";(()=>{var e={};e.id=857,e.ids=[857],e.modules={4217:e=>{e.exports=require("micro")},2799:e=>{e.exports=require("micro-cors")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6090:e=>{e.exports=import("stripe")},6840:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>i,default:()=>c,routeModule:()=>u});var o=a(1802),r=a(7153),n=a(6249),d=a(7385),l=e([d]);d=(l.then?(await l)():l)[0];let c=(0,n.l)(d,"default"),i=(0,n.l)(d,"config"),u=new o.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/webhooks",pathname:"/api/webhooks",bundlePath:"",filename:""},userland:d});s()}catch(e){s(e)}})},7385:(e,t,a)=>{a.a(e,async(e,s)=>{try{a.r(t),a.d(t,{config:()=>u,default:()=>h});var o=a(6090),r=a(4217),n=a(2799),d=a.n(n),l=e([o]);o=(l.then?(await l)():l)[0];let c=new o.default("sk_test_51O5M2yCFauPt80gYZEQ8OwczH7Z4NAy9rgOkw1wD2CleIf3nMiUdHq7C7e3Wdlbe2aisbdEeLuhMM8ZK5aOYsLps00GOkvI38F"),i=process.env.STRIPE_WEBHOOK_SECRET,u={api:{bodyParser:!1}},p=d()({allowMethods:["POST","HEAD"]}),webhookHandler=async(e,t)=>{if("POST"===e.method){let a;let s=await (0,r.buffer)(e),o=e.headers["stripe-signature"];try{a=c.webhooks.constructEvent(s.toString(),o,i)}catch(e){console.log(`❌ Error message: ${e.message}`),t.status(400).send(`Webhook Error: ${e.message}`);return}switch(console.log("✅ Success:",a.id),a.type){case"payment_intent.succeeded":{let e=a.data.object;console.log(`PaymentIntent status: ${e.status}`);break}case"payment_intent.payment_failed":{let e=a.data.object;console.log(`❌ Payment failed: ${e.last_payment_error?.message}`);break}case"charge.succeeded":{let e=a.data.object;console.log(`Charge id: ${e.id}`);break}default:console.warn(`Unhandled event type: ${a.type}`)}t.json({received:!0})}else t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed")},h=p(webhookHandler);s()}catch(e){s(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[222],()=>__webpack_exec__(6840));module.exports=a})();